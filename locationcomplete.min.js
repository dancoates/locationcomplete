(function(b,a,c){b.fn.locationComplete=function(i){var f=this;var s=f.val();var r;var j=null;var k=0;var q={limit:10,interval:100,postCodeIndex:0,stateIndex:2,placeIndex:1,maxHeight:200,searchAfter:2,resultsElement:"ul",resultElement:"li",resultsClass:"lc-results-container",resultClass:"lc-result-item"};
var p=["url"];var w=b.extend(q,i);function v(){var z=p.length;while(z--){if(!w[p[z]]){console.error("Error: "+p[z]+" is not defined");return;}}f.data("placeholder",f.attr("placeholder"));
f.attr("placeholder","Loading locations...");d();}function d(){b.ajax({url:w.url,success:g,error:function(){console.error("Error: Data load failed");}});
}function g(D){var z=D.split("\n");var C=z.length;var B=[];if(C===1){console.error("Error: error parsing csv, check line endings - they should be unix");
return;}while(C--){var A={};A.value=z[C];var E=z[C].split(",");A.tokens=E[w.placeIndex].split(" ").concat([E[w.postCodeIndex],E[w.stateIndex]]);B.push(A);
}j=B;t();}function t(z){f.on("focus",y);f.on("blur",x);f.attr("placeholder",f.data("placeholder"));u([]);}function y(z){r=setInterval(o,w.interval);}function x(){b("."+w.resultsClass).hide();
clearInterval(r);}function o(){if(f.val()===s){return;}var z=f.val().toLowerCase();if(z.length<=w.searchAfter){if(b("."+w.resultClass).length>0){u([]);
s=f.val();}return;}if(z.split(",").length>2){if(b("."+w.resultClass).length>0){u([]);s=f.val();}return;}var B=z.split(" ");var E=[];var F=j.length;var A=new Date().getTime();
while(F--){var I=false;var H=0;var C=B.length;while(C--){if(B[C].length>1){var D=j[F].tokens.length;if(j[F].value.indexOf(B[C])!==-1){I=true;while(D--){if(j[F].tokens[D].indexOf(B[C])!==-1){H++;
if(j[F].tokens[D]===B[C]){H++;}}}}}}if(I){var G=H/j[F].tokens.length;E.push([j[F].value,G]);}}E=E.sort(function(K,J){return K[1]<J[1]?1:-1;});E=E.slice(0,w.limit);
s=f.val();console.log("processing took "+(new Date().getTime()-A)+"ms");u(E);}function u(C){var A=new Date().getTime();var J=b("."+w.resultsClass);var I=J.length>0;
J=I?J:b("<"+w.resultsElement+' style="max-height:'+w.maxHeight+'px; overflow-y: auto;"/>').addClass(w.resultsClass);if(C.length===0){if(f.val().length<w.searchAfter){J.empty();
}J.hide();return;}var E="";for(var D=0;D<C.length;D++){var H=C[D][0].split(",");var F=H[0];var B=h(H[1]);var z=H[2].toUpperCase();var G=D===0?"lc-focused":"";
E+='<li class="'+w.resultClass+" "+G+'">';E+=(B+", "+z+", "+F);E+="</li>";}J.empty().html(E).scrollTop(0);if(!I){f.after(J);e(J);}else{J.show();}console.log("drawing took "+(new Date().getTime()-A)+"ms");
}function e(z){b("."+w.resultsClass).on("mouseenter mouseleave","."+w.resultClass,function(A){b(".lc-focused").removeClass("lc-focused");b(this).toggleClass("lc-focused");
});b("."+w.resultsClass).on("mousedown","."+w.resultClass,function(A){l(A,f[0]);});f.on("keydown",function(D){switch(D.keyCode){case 38:m(D,this);break;
case 40:n(D,this);break;case 13:case 9:l(D,this);break;default:return;}var B=b(".lc-focused");if(B.length===0){return;}var C=B.offset().top;var A=(z.height()/2)-(B.height()/2)+z.offset().top-z.scrollTop();
var E=C-A;if(E>0){z.scrollTop(E);}else{z.scrollTop(0);}});}function m(C,B){if(B.value.length<=w.searchAfter){return;}C.preventDefault();var A=b(".lc-focused");
A.removeClass("lc-focused");var z=A.prev();if(A.length===0||z.length===0){b("."+w.resultClass).last().addClass("lc-focused");}else{z.addClass("lc-focused");
}}function n(C,B){if(B.value.length<=w.searchAfter){return;}C.preventDefault();var A=b(".lc-focused");A.removeClass("lc-focused");var z=A.next();if(A.length===0||z.length===0){b("."+w.resultClass).first().addClass("lc-focused");
}else{z.addClass("lc-focused");}}function l(B,A){var z=b(".lc-focused");if((A.value.split(",").length===3&&A.value===z.text())||A.value.length<w.searchAfter){return;
}B.preventDefault();if(z.length===0){z=b("."+w.resultClass).first();}f.val(z.text());o();}(function(){var D;var C=function(){};var A=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];
var B=A.length;var z=(a.console=a.console||{});while(B--){D=A[B];if(!z[D]){z[D]=C;}}}());function h(z){return z.replace(/\w\S*/g,function(A){return A.charAt(0).toUpperCase()+A.substr(1).toLowerCase();
});}v();return this;};})(jQuery,window);